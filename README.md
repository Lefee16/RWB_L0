# Демонстрация

https://github.com/user-attachments/assets/a4542ead-c463-414e-853e-1eccfd7ff30c

# RWB L0 - Сервис заказов

## Описание проекта

Микросервис для получения, хранения и отдачи данных о заказах. Сервис получает заказы из NATS Streaming, сохраняет их в PostgreSQL и предоставляет доступ через REST API и Web интерфейс. Реализован in-memory кэш для быстрого доступа к данным. При старте сервиса кэш автоматически восстанавливается из базы данных.

## Архитектура

Проект построен по принципам Clean Architecture с разделением на слои:

**Domain Layer** - содержит бизнес-модели (Order, Delivery, Payment, Item) без зависимостей от внешних фреймворков.

**Use Case Layer** - реализует бизнес-логику приложения: создание заказов, получение из кэша/БД, восстановление кэша, управление статистикой.

**Adapters Layer** - адаптеры для работы с внешними системами:
- PostgreSQL репозиторий с нормализованной схемой (3NF)
- In-memory кэш 

**Controllers Layer** - точки входа в приложение:
- HTTP контроллер (REST API и Web UI)
- NATS контроллер (обработка сообщений из очереди)

**База данных** разбита на 4 нормализованные таблицы (3NF): `orders`, `deliveries`, `payments`, `items` с foreign key constraints и каскадным удалением.

## Технологический стек

- **Go 1.25** - язык программирования
- **PostgreSQL 16** - реляционная база данных
- **NATS Streaming** - брокер сообщений для асинхронной обработки
- **Docker & Docker Compose** - контейнеризация и оркестрация
- **Golang-migrate** - управление миграциями БД
- **Testify** - фреймворк для unit тестирования

**Дополнительные возможности:**
- Graceful shutdown 
- Healthcheck endpoints для мониторинга
- Автоматические миграции при старте
- Unit тесты 

## Быстрый старт (c использованием docker-compose)

Запуск всех сервисов

``` docker-compose up -d ```

Сервис будет доступен на http://localhost:8080

Отправить тестовые данные в NATS

``` go run amqp-test/publisher_test.go ```

## Конфигурация

Создайте файл `.env` на основе `.env.example`

`cp .env.example .env`
